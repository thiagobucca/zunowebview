<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Custom Extension Field - Contentstack com Preview</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f8f9fa;
            color: #333;
            line-height: 1.5;
        }

        .container {
            display: flex;
            height: 100vh;
        }

        .left-panel {
            flex: 1;
            background: white;
            padding: 24px;
            overflow-y: auto;
            height: 100vh;
        }

        /* Custom scrollbar for left panel */
        .left-panel {
            scrollbar-width: thin;
            scrollbar-color: rgba(0, 0, 0, 0.1) transparent;
        }

        .left-panel::-webkit-scrollbar {
            width: 2px;
        }

        .left-panel::-webkit-scrollbar-track {
            background: transparent;
        }

        .left-panel::-webkit-scrollbar-thumb {
            background: rgba(0, 0, 0, 0.1);
            border-radius: 2px;
        }

        .left-panel::-webkit-scrollbar-thumb:hover {
            background: rgba(0, 0, 0, 0.2);
        }

        .right-panel {
            flex: 1;
            display: flex;
            justify-content: center;
            align-items: center;
            position: sticky;
            top: 0;
            height: 100vh;
            background: #f8f9fa;
            background-image: radial-gradient(circle, #d0d0d0 1px, transparent 1px);
            background-size: 20px 20px;
        }

        h1 {
            color: #2c3e50;
            margin-bottom: 24px;
            font-size: 24px;
            font-weight: 600;
        }

        h2 {
            color: #34495e;
            margin: 24px 0 16px 0;
            font-size: 18px;
            font-weight: 600;
        }

        .field-group {
            margin-bottom: 16px;
        }

        label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: #555;
        }

        input, textarea {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
            transition: border-color 0.2s;
        }

        input:focus, textarea:focus {
            outline: none;
            border-color: #007bff;
            box-shadow: 0 0 0 3px rgba(0,123,255,0.1);
        }

        textarea {
            resize: vertical;
            min-height: 80px;
        }

        .categories-section {
            margin: 24px 0;
        }

        .categories-accordion {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .category-accordion {
            border: 1px solid #ddd;
            border-radius: 8px;
            background: white;
            overflow: hidden;
            transition: all 0.2s ease;
        }

        .category-accordion.dragging {
            opacity: 0.5;
            transform: rotate(2deg);
        }

        .category-header {
            display: flex;
            align-items: center;
            padding: 12px 16px;
            cursor: pointer;
            background: #f8f9fa;
            border-bottom: 1px solid transparent;
            transition: all 0.2s ease;
        }

        .category-header:hover {
            background: #e9ecef;
        }

        .category-accordion.expanded .category-header {
            border-bottom-color: #ddd;
        }

        .category-drag-handle {
            margin-right: 8px;
            color: #999;
            cursor: grab;
            font-size: 14px;
            line-height: 1;
        }

        .category-drag-handle:active {
            cursor: grabbing;
        }

        .category-checkbox {
            width: 18px;
            height: 18px;
            cursor: pointer;
            margin: 0 12px 0 0;
        }

        .category-name {
            font-weight: 500;
            color: #333;
            flex: 1;
        }

        .category-status {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .accordion-arrow {
            font-size: 12px;
            color: #666;
            transition: transform 0.2s ease;
        }

        .category-accordion.expanded .accordion-arrow {
            transform: rotate(90deg);
        }

        .category-content {
            padding: 0;
            max-height: 0;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .category-accordion.expanded .category-content {
            max-height: 2000px;
            padding: 16px;
        }

        .layout-selector {
            margin-bottom: 20px;
        }

        .layout-selector h4 {
            margin: 0 0 12px 0;
            font-size: 14px;
            color: #333;
        }

        .layout-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 8px;
        }

        .layout-option {
            border: 1px solid #e0e0e0;
            border-radius: 4px;
            padding: 6px;
            cursor: pointer;
            transition: all 0.2s;
            text-align: center;
            background: white;
        }

        .layout-option:hover {
            border-color: #007bff;
            transform: translateY(-1px);
            box-shadow: 0 1px 3px rgba(0,123,255,0.1);
        }

        .layout-option.selected {
            border-color: #007bff;
            background: #f0f8ff;
        }

        .layout-option span {
            display: block;
            margin-top: 4px;
            font-size: 9px;
            font-weight: 500;
            color: #333;
        }

        .layout-visual {
            width: 30px;
            height: 22px;
            margin: 0 auto 2px auto;
            border-radius: 2px;
            overflow: hidden;
        }

        .layout-1 .layout-visual {
            background: linear-gradient(to bottom, #ff69b4 0%, #ff69b4 100%);
        }

        .layout-2 .layout-visual {
            background: linear-gradient(to bottom, #ff69b4 0%, #ff69b4 78%, transparent 78%, transparent 82%, #ff69b4 82%, #ff69b4 100%);
        }

        .layout-3 .layout-visual {
            background: linear-gradient(to bottom, #ff69b4 0%, #ff69b4 50%, transparent 50%, transparent 100%);
        }

        .layout-4 .layout-visual {
            background: linear-gradient(to right, #ff69b4 0%, #ff69b4 33%, transparent 33%, transparent 66%, #ff69b4 66%, #ff69b4 100%);
        }

        .status-badge {
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 500;
        }

        .status-badge.configured {
            background: #d4edda;
            color: #155724;
        }

        .status-badge.empty {
            background: #f8d7da;
            color: #721c24;
        }

        .configure-button {
            padding: 6px 12px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            font-weight: 500;
            transition: background 0.2s;
        }

        .configure-button:hover {
            background: #0056b3;
        }

        .active-config {
            margin-top: 24px;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
            background: #f9f9f9;
        }

        .active-config.hidden {
            display: none;
        }

        .config-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .config-header h3 {
            color: #2c3e50;
            font-size: 16px;
            margin: 0;
        }

        .cancel-button {
            padding: 6px 12px;
            background: #dc3545;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
        }

        .cancel-button:hover {
            background: #c82333;
        }

        .layouts-section {
            margin-bottom: 24px;
        }

        .layouts-title {
            margin-bottom: 12px;
            font-size: 14px;
            font-weight: 600;
            color: #555;
        }

        .layouts-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 12px;
        }

        .layout-option {
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            cursor: pointer;
            text-align: center;
            transition: all 0.2s;
            background: white;
        }

        .layout-option:hover {
            border-color: #007bff;
        }

        .layout-option.selected {
            border-color: #007bff;
            background: #e3f2fd;
        }

        .layout-visual {
            width: 100%;
            height: 60px;
            margin-bottom: 8px;
            border-radius: 4px;
            position: relative;
        }

        .layout-1 .layout-visual {
            background: linear-gradient(to bottom, #ff69b4 0%, #ff69b4 100%);
        }

        .layout-2 .layout-visual {
            background: linear-gradient(to bottom, #ff69b4 0%, #ff69b4 78%, transparent 78%, transparent 82%, #ff69b4 82%, #ff69b4 100%);
        }

        .layout-3 .layout-visual {
            background: linear-gradient(to bottom, #ff69b4 0%, #ff69b4 40%, transparent 40%, transparent 45%, #ff69b4 45%, #ff69b4 70%, transparent 70%, transparent 75%, #ff69b4 75%, #ff69b4 100%);
        }

        .layout-4 .layout-visual {
            background: linear-gradient(to bottom, #ff69b4 0%, #ff69b4 30%, transparent 30%, transparent 35%, #ff69b4 35%, #ff69b4 65%, transparent 65%, transparent 70%, #ff69b4 70%, #ff69b4 100%);
        }

        .layout-name {
            font-size: 12px;
            font-weight: 500;
            color: #666;
        }

        .fields-section {
            margin-top: 20px;
        }

        .fields-section.hidden {
            display: none;
        }

        .cards-container {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .card-item {
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 16px;
            background: white;
        }

        .card-title {
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 12px;
            font-size: 14px;
        }

        .card-fields {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .field-input {
            font-size: 13px;
        }

        /* Phone Preview Styles */
        .phone-container {
            width: 400px;
            height: 800px;
            background: #000;
            border-radius: 30px;
            padding: 10px;
            box-shadow: 0 12px 40px rgba(0,0,0,0.4);
            position: relative;
        }

        .phone-screen {
            width: 100%;
            height: 100%;
            background: #f5f5f5;
            border-radius: 22px;
            overflow: hidden;
            position: relative;
        }

        .phone-header {
            height: 44px;
            background: #f5f5f5;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
            font-size: 14px;
            font-weight: 600;
            color: #000;
        }

        .phone-close {
            position: absolute;
            top: 60px;
            right: 30px;
            width: 24px;
            height: 24px;
            background: transparent;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            color: #444;
            font-weight: 600;
            z-index: 20;
        }

        .phone-avatar {
            position: absolute;
            top: 110px;
            left: 20px;
            width: 40px;
            height: 40px;
            background: #ff6b35;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            z-index: 15;
            transition: opacity 0.3s ease;
        }

        .phone-avatar.hidden-on-scroll {
            opacity: 0;
            pointer-events: none;
        }

        .phone-content {
            height: calc(100% - 44px);
            overflow-y: auto;
            position: relative;
        }

        /* Custom scrollbar for phone preview */
        .phone-content {
            scrollbar-width: thin;
            scrollbar-color: rgba(0, 0, 0, 0.08) transparent;
        }

        .phone-content::-webkit-scrollbar {
            width: 1px;
        }

        .phone-content::-webkit-scrollbar-track {
            background: transparent;
        }

        .phone-content::-webkit-scrollbar-thumb {
            background: rgba(0, 0, 0, 0.08);
            border-radius: 2px;
        }

        .phone-content::-webkit-scrollbar-thumb:hover {
            background: rgba(0, 0, 0, 0.15);
        }

        .phone-initial-content {
            padding: 130px 0 20px 0;
            position: relative;
            z-index: 2;
        }

        .phone-sticky-header {
            position: sticky;
            top: -200px;
            background: #f5f5f5;
            z-index: 10;
            padding: 40px 20px 16px 20px;
            border-bottom: 1px solid rgba(0,0,0,0.1);
            margin-top: -44px;
            transition: top 0.3s ease, padding 0.3s ease;
        }

        .phone-sticky-header.scrolled {
            top: 0;
            padding: 2px 20px 14px 20px;
            padding-top: 62px;
            margin-top: -64px;
        }

        .phone-background-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            opacity: 0.3;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }

        .phone-background-overlay.hidden-on-scroll {
            opacity: 0;
        }

        .phone-scrollable-content {
            padding: 20px;
            position: relative;
            z-index: 2;
            display: flex;
            flex-direction: column;
            min-height: calc(100vh - 200px);
        }

        .phone-text {
            background: transparent;
            padding: 0;
            border-radius: 0;
            margin: 0 20px 20px 20px;
            font-size: 16px;
            color: #000000;
            line-height: 1.4;
            font-weight: 700;
            opacity: 1;
            transition: opacity 0.3s ease;
            word-wrap: break-word;
            overflow-wrap: break-word;
        }

        .phone-text.hidden-on-scroll {
            opacity: 0;
            pointer-events: none;
        }

        .phone-chips {
            display: flex;
            gap: 8px;
            flex-wrap: nowrap;
            overflow-x: auto;
            scrollbar-width: thin; /* Firefox */
        }

        .phone-chips::-webkit-scrollbar {
            height: 1px; /* Chrome, Safari and Opera */
        }

        .phone-chips::-webkit-scrollbar-track {
            background: rgba(0,0,0,0.1);
            border-radius: 1px;
        }

        .phone-chips::-webkit-scrollbar-thumb {
            background: rgba(0,0,0,0.3);
            border-radius: 1px;
        }

        .phone-chips::-webkit-scrollbar-thumb:hover {
            background: rgba(0,0,0,0.5);
        }

        .phone-chips-in-content {
            margin-bottom: 20px;
        }

        .phone-chip {
            padding: 6px 12px;
            background: #fff;
            border: 0px solid #e0e0e0;
            border-radius: 10px;
            font-size: 12px;
            color: #000;
            font-weight: 500;
            white-space: nowrap;
            flex-shrink: 0;
        }

        .phone-chip.active {
            background: #fff;
            color: #000;
            border: 1px solid #ff6b35;
        }

        .phone-chip.selected {
            background: #fff;
            color: #000;
            border: 2px solid #ff6b35;
            border-radius: 12px;
        }

        .phone-chip.edit {
            background: #ff6b35;
            color: #fff;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            min-width: 32px;
            cursor: pointer;
            flex-shrink: 0;
        }

        .phone-offers {
            display: flex;
            flex-direction: column;
            gap: 16px;
            margin-bottom: 24px;
        }

        .preview-message {
            text-align: center;
            color: #999;
            font-style: italic;
            padding: 40px 20px;
        }

        /* Layout 2 Preview Styles */
        .layout2-container {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }

        .layout2-title {
            font-size: 14px;
            font-weight: 600;
            color: #333;
            margin-bottom: 12px;
            text-align: left;
        }

        .layout2-card1 {
            position: relative;
            height: 320px;
            border-radius: 12px;
            overflow: hidden;
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            display: flex;
            flex-direction: column;
            justify-content: flex-end;
            padding: 16px;
            color: white;
        }


        .layout2-card1::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(to bottom, transparent 0%, rgba(0,0,0,0.7) 100%);
            z-index: 1;
        }

        .layout2-card1-content {
            position: relative;
            z-index: 2;
            display: flex;
            align-items: flex-end;
            justify-content: space-between;
        }

        .layout2-card1-text {
            flex: 1;
        }

        .layout2-card1-title {
            font-size: 12px;
            opacity: 0.9;
            margin-bottom: 4px;
        }

        .layout2-card1-description {
            font-size: 16px;
            font-weight: 600;
            line-height: 1.3;
        }

        .layout2-card1-arrow {
            font-size: 24px;
            margin-left: 12px;
            opacity: 0.9;
        }

        .layout2-card2 {
            background: white;
            border-radius: 12px;
            padding: 16px;
            position: relative;
            min-height: 100px;
        }

        .layout2-card2-icon {
            position: absolute;
            top: 16px;
            left: 16px;
            font-size: 24px;
        }

        .layout2-card2-content {
            margin-top: 40px;
            display: flex;
            align-items: flex-end;
            justify-content: space-between;
        }

        .layout2-card2-text {
            flex: 1;
        }

        .layout2-card2-title {
            font-size: 14px;
            font-weight: 600;
            color: #333;
            margin-bottom: 4px;
        }

        .layout2-card2-description {
            font-size: 13px;
            color: #666;
            line-height: 1.3;
        }

        .layout2-card2-arrow {
            font-size: 20px;
            color: #666;
            margin-left: 12px;
        }

        /* Layout 1 Preview Styles */
        .layout1-container {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .layout1-title {
            font-size: 14px;
            font-weight: 600;
            color: #333;
            margin-bottom: 12px;
            text-align: left;
        }

        .layout1-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            position: relative;
            min-height: 200px;
        }

        .layout1-card-icon {
            position: absolute;
            top: 20px;
            left: 20px;
            font-size: 32px;
        }

        .layout1-card-content {
            margin-top: 60px;
            text-align: left;
        }

        .layout1-card-title {
            font-size: 16px;
            font-weight: 500;
            color: #666;
            margin-bottom: 12px;
        }

        .layout1-card-description {
            font-size: 18px;
            font-weight: 700;
            color: #333;
            line-height: 1.4;
            margin-bottom: 20px;
        }

        .layout1-bullets {
            margin-bottom: 20px;
        }

        .layout1-bullet {
            display: flex;
            align-items: flex-start;
            margin-bottom: 12px;
            gap: 8px;
        }

        .layout1-bullet-icon {
            font-size: 16px;
            color: #4caf50;
            margin-top: 2px;
            flex-shrink: 0;
        }

        .layout1-bullet-text {
            font-size: 14px;
            color: #333;
            line-height: 1.4;
        }

        .layout1-cta {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 16px;
            font-weight: 600;
            color: #333;
        }

        .layout1-cta-arrow {
            font-size: 18px;
            color: #666;
        }

        /* Layout 4 Preview Styles */
        .layout4-container {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .layout4-title {
            font-size: 14px;
            font-weight: 600;
            color: #333;
            margin-bottom: 12px;
            text-align: left;
        }

        .layout4-card1 {
            background: linear-gradient(135deg, #1a237e, #3949ab);
            border-radius: 12px;
            padding: 16px;
            color: white;
            position: relative;
            min-height: 100px;
            display: flex;
            flex-direction: column;
        }

        .layout4-card1-icon {
            position: absolute;
            top: 16px;
            left: 16px;
            font-size: 24px;
        }

        .layout4-card1-content {
            margin-top: 40px;
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: flex-end;
        }

        .layout4-card1-text {
            display: block;
        }

        .layout4-card1-footer {
            display: flex;
            align-items: flex-end;
            justify-content: space-between;
            margin-top: 8px;
        }

        .layout4-card1-arrow {
            font-size: 20px;
            color: white;
        }

        .layout4-card1-title {
            font-size: 14px;
            opacity: 0.9;
            line-height: 1.3;
        }

        .layout4-card1-description {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .layout4-card {
            background: white;
            border-radius: 12px;
            padding: 16px;
            position: relative;
            min-height: 100px;
            display: flex;
            flex-direction: column;
        }

        .layout4-card-icon {
            position: absolute;
            top: 16px;
            left: 16px;
            font-size: 24px;
        }

        .layout4-card-content {
            margin-top: 40px;
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .layout4-card-text {
            flex: 1;
        }

        .layout4-card-title {
            font-size: 14px;
            color: #666;
            line-height: 1.3;
        }

        .layout4-card-description {
            font-size: 16px;
            font-weight: 600;
            color: #333;
            margin-bottom: 8px;
        }

        .layout4-card-footer {
            display: flex;
            align-items: flex-end;
            justify-content: space-between;
            margin-top: 8px;
        }

        .layout4-card-arrow {
            font-size: 20px;
            color: #666;
        }

        /* Footer Styles */
        .phone-footer {
            margin-top: auto;
            padding-top: 24px;
            padding-bottom: 20px;
            border-top: 1px solid rgba(0, 0, 0, 0.08);
        }

        .footer-title {
            font-size: 18px;
            font-weight: 600;
            color: #333;
            margin-bottom: 16px;
            text-align: left;
        }

        .footer-card {
            background: #ff6b35;
            border-radius: 12px;
            padding: 16px;
            position: relative;
            min-height: 120px;
            display: flex;
            align-items: flex-end;
            justify-content: space-between;
        }

        .footer-card-content {
            flex: 1;
        }

        .footer-card-title {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.9);
            line-height: 1.3;
            margin-bottom: 4px;
        }

        .footer-card-description {
            font-size: 16px;
            font-weight: 600;
            color: white;
        }

        .footer-card-arrow {
            font-size: 20px;
            color: white;
            margin-left: 12px;
        }

        /* Layout 3 Preview Styles */
        .layout3-container {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .layout3-title {
            font-size: 14px;
            font-weight: 600;
            color: #333;
            margin-bottom: 12px;
            text-align: left;
        }

        .layout3-card1 {
            background: linear-gradient(135deg, #ff6b35, #f7931e);
            border-radius: 12px;
            padding: 16px;
            color: white;
            position: relative;
            min-height: 80px;
            display: flex;
            align-items: center;
        }

        .layout3-card1-icon {
            position: absolute;
            top: 12px;
            left: 12px;
            font-size: 20px;
        }

        .layout3-card1-content {
            margin-left: 40px;
            flex: 1;
        }

        .layout3-card1-title {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 4px;
        }

        .layout3-card1-description {
            font-size: 13px;
            opacity: 0.9;
            line-height: 1.3;
        }

        .layout3-cards-row {
            display: flex;
            gap: 8px;
        }

        .layout3-card {
            flex: 1;
            background: white;
            border-radius: 12px;
            padding: 16px;
            text-align: center;
            min-height: 120px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .layout3-card-icon {
            font-size: 24px;
            margin-bottom: 12px;
        }

        .layout3-card-content {
            flex: 1;
        }

        .layout3-card-title {
            font-size: 12px;
            font-weight: 600;
            color: #333;
            margin-bottom: 4px;
        }

        .layout3-card-description {
            font-size: 11px;
            color: #666;
            line-height: 1.3;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Painel Esquerdo - Configuração -->
        <div class="left-panel">
            <h1>📝 Configuração</h1>
            
            <!-- Campos globais -->
            <div class="field-group">
                <label for="background-image">Imagem de Fundo (URL):</label>
                <input type="text" id="background-image" placeholder="https://exemplo.com/imagem.jpg">
            </div>
            
            <div class="field-group">
                <label for="main-text">Texto Principal:</label>
                <textarea id="main-text" placeholder="João, com base no seu perfil, preparamos estas ofertas especiais para você!"></textarea>
            </div>

            <h2>📋 Categorias</h2>
            <p style="font-size: 12px; color: #666; margin-bottom: 16px;">✓ Marque as categorias que deseja usar • ⋮⋮ Arraste para reordenar</p>
            
            <div class="categories-accordion" id="categories-accordion">
                <div class="category-accordion" data-category="credito">
                    <div class="category-header">
                        <div class="category-drag-handle">⋮⋮</div>
                        <input type="checkbox" id="cat-credito" class="category-checkbox">
                        <span class="category-name">Crédito</span>
                        <div class="category-status">
                            <span id="status-credito" class="status-badge empty">Vazio</span>
                            <span class="accordion-arrow">▶</span>
                        </div>
                    </div>
                    <div class="category-content">
                        <!-- Layout selection and configuration will go here -->
                        <div class="layout-selector">
                            <h4>Escolha o Layout:</h4>
                            <div class="layout-grid">
                                <div class="layout-option" data-layout="1">
                                    <div class="layout-visual">
                                        <div class="layout-1">
                                            <div class="layout-visual"></div>
                                        </div>
                                    </div>
                                    <span>Layout 1</span>
                                </div>
                                <div class="layout-option" data-layout="2">
                                    <div class="layout-visual">
                                        <div class="layout-2">
                                            <div class="layout-visual"></div>
                                        </div>
                                    </div>
                                    <span>Layout 2</span>
                                </div>
                                <div class="layout-option" data-layout="3">
                                    <div class="layout-visual">
                                        <div class="layout-3">
                                            <div class="layout-visual"></div>
                                        </div>
                                    </div>
                                    <span>Layout 3</span>
                                </div>
                                <div class="layout-option" data-layout="4">
                                    <div class="layout-visual">
                                        <div class="layout-4">
                                            <div class="layout-visual"></div>
                                        </div>
                                    </div>
                                    <span>Layout 4</span>
                                </div>
                            </div>
                        </div>
                        <div class="category-fields" id="fields-credito">
                            <!-- Fields will be inserted here based on selected layout -->
                        </div>
                    </div>
                </div>

                <div class="category-accordion" data-category="debito">
                    <div class="category-header">
                        <div class="category-drag-handle">⋮⋮</div>
                        <input type="checkbox" id="cat-debito" class="category-checkbox">
                        <span class="category-name">Débito</span>
                        <div class="category-status">
                            <span id="status-debito" class="status-badge empty">Vazio</span>
                            <span class="accordion-arrow">▶</span>
                        </div>
                    </div>
                    <div class="category-content">
                        <!-- Same layout selector structure for each category -->
                        <div class="layout-selector">
                            <h4>Escolha o Layout:</h4>
                            <div class="layout-grid">
                                <div class="layout-option" data-layout="1">
                                    <div class="layout-visual">
                                        <div class="layout-1">
                                            <div class="layout-visual"></div>
                                        </div>
                                    </div>
                                    <span>Layout 1</span>
                                </div>
                                <div class="layout-option" data-layout="2">
                                    <div class="layout-visual">
                                        <div class="layout-2">
                                            <div class="layout-visual"></div>
                                        </div>
                                    </div>
                                    <span>Layout 2</span>
                                </div>
                                <div class="layout-option" data-layout="3">
                                    <div class="layout-visual">
                                        <div class="layout-3">
                                            <div class="layout-visual"></div>
                                        </div>
                                    </div>
                                    <span>Layout 3</span>
                                </div>
                                <div class="layout-option" data-layout="4">
                                    <div class="layout-visual">
                                        <div class="layout-4">
                                            <div class="layout-visual"></div>
                                        </div>
                                    </div>
                                    <span>Layout 4</span>
                                </div>
                            </div>
                        </div>
                        <div class="category-fields" id="fields-debito">
                        </div>
                    </div>
                </div>

                <div class="category-accordion" data-category="beneficios">
                    <div class="category-header">
                        <div class="category-drag-handle">⋮⋮</div>
                        <input type="checkbox" id="cat-beneficios" class="category-checkbox">
                        <span class="category-name">Benefícios</span>
                        <div class="category-status">
                            <span id="status-beneficios" class="status-badge empty">Vazio</span>
                            <span class="accordion-arrow">▶</span>
                        </div>
                    </div>
                    <div class="category-content">
                        <div class="layout-selector">
                            <h4>Escolha o Layout:</h4>
                            <div class="layout-grid">
                                <div class="layout-option" data-layout="1">
                                    <div class="layout-visual">
                                        <div class="layout-1">
                                            <div class="layout-visual"></div>
                                        </div>
                                    </div>
                                    <span>Layout 1</span>
                                </div>
                                <div class="layout-option" data-layout="2">
                                    <div class="layout-visual">
                                        <div class="layout-2">
                                            <div class="layout-visual"></div>
                                        </div>
                                    </div>
                                    <span>Layout 2</span>
                                </div>
                                <div class="layout-option" data-layout="3">
                                    <div class="layout-visual">
                                        <div class="layout-3">
                                            <div class="layout-visual"></div>
                                        </div>
                                    </div>
                                    <span>Layout 3</span>
                                </div>
                                <div class="layout-option" data-layout="4">
                                    <div class="layout-visual">
                                        <div class="layout-4">
                                            <div class="layout-visual"></div>
                                        </div>
                                    </div>
                                    <span>Layout 4</span>
                                </div>
                            </div>
                        </div>
                        <div class="category-fields" id="fields-beneficios">
                        </div>
                    </div>
                </div>

                <div class="category-accordion" data-category="protecao">
                    <div class="category-header">
                        <div class="category-drag-handle">⋮⋮</div>
                        <input type="checkbox" id="cat-protecao" class="category-checkbox">
                        <span class="category-name">Proteção</span>
                        <div class="category-status">
                            <span id="status-protecao" class="status-badge empty">Vazio</span>
                            <span class="accordion-arrow">▶</span>
                        </div>
                    </div>
                    <div class="category-content">
                        <div class="layout-selector">
                            <h4>Escolha o Layout:</h4>
                            <div class="layout-grid">
                                <div class="layout-option" data-layout="1">
                                    <div class="layout-visual">
                                        <div class="layout-1">
                                            <div class="layout-visual"></div>
                                        </div>
                                    </div>
                                    <span>Layout 1</span>
                                </div>
                                <div class="layout-option" data-layout="2">
                                    <div class="layout-visual">
                                        <div class="layout-2">
                                            <div class="layout-visual"></div>
                                        </div>
                                    </div>
                                    <span>Layout 2</span>
                                </div>
                                <div class="layout-option" data-layout="3">
                                    <div class="layout-visual">
                                        <div class="layout-3">
                                            <div class="layout-visual"></div>
                                        </div>
                                    </div>
                                    <span>Layout 3</span>
                                </div>
                                <div class="layout-option" data-layout="4">
                                    <div class="layout-visual">
                                        <div class="layout-4">
                                            <div class="layout-visual"></div>
                                        </div>
                                    </div>
                                    <span>Layout 4</span>
                                </div>
                            </div>
                        </div>
                        <div class="category-fields" id="fields-protecao">
                        </div>
                    </div>
                </div>
            </div>

            <!-- Seção de configuração ativa -->
            <div id="active-config" class="active-config hidden">
                <div class="config-header">
                    <h3 id="config-title">Configurando: --</h3>
                    <button class="cancel-button" onclick="cancelConfiguration()">✕ Cancelar</button>
                </div>

                <!-- Seleção de layout -->
                <div class="layouts-section">
                    <h4 class="layouts-title">Escolha o Layout:</h4>
                    <div class="layouts-grid">
                        <div class="layout-option layout-1" onclick="selectLayout(1)">
                            <div class="layout-visual"></div>
                            <span class="layout-name">Layout 1</span>
                        </div>
                        <div class="layout-option layout-2" onclick="selectLayout(2)">
                            <div class="layout-visual"></div>
                            <span class="layout-name">Layout 2</span>
                        </div>
                        <div class="layout-option layout-3" onclick="selectLayout(3)">
                            <div class="layout-visual"></div>
                            <span class="layout-name">Layout 3</span>
                        </div>
                        <div class="layout-option layout-4" onclick="selectLayout(4)">
                            <div class="layout-visual"></div>
                            <span class="layout-name">Layout 4</span>
                        </div>
                    </div>
                </div>

                <!-- Campos do Layout 2 -->
                <div id="fields-layout-2" class="fields-section hidden">
                    <div class="cards-container">
                        <div class="card-item">
                            <div class="card-title">Card 1 (Com Imagem de Fundo)</div>
                            <div class="card-fields">
                                <div class="field-group">
                                    <label for="layout2-card1-bg">Imagem de Background:</label>
                                    <input type="text" id="layout2-card1-bg" class="field-input" placeholder="URL da imagem">
                                </div>
                                <div class="field-group">
                                    <label for="layout2-card1-title">Título da Oferta:</label>
                                    <input type="text" id="layout2-card1-title" class="field-input" placeholder="Cofrinhos">
                                </div>
                                <div class="field-group">
                                    <label for="layout2-card1-description">Descrição da Oferta:</label>
                                    <input type="text" id="layout2-card1-description" class="field-input" placeholder="Organize suas economias e realize seus planos">
                                </div>
                                <div class="field-group">
                                    <label for="layout2-card1-deeplink">Deeplink:</label>
                                    <input type="text" id="layout2-card1-deeplink" class="field-input" placeholder="URL do deeplink">
                                </div>
                            </div>
                        </div>
                        
                        <div class="card-item">
                            <div class="card-title">Card 2 (Fundo Branco)</div>
                            <div class="card-fields">
                                <div class="field-group">
                                    <label for="layout2-card2-icon">Ícone:</label>
                                    <input type="text" id="layout2-card2-icon" class="field-input" placeholder="📊">
                                </div>
                                <div class="field-group">
                                    <label for="layout2-card2-title">Título da Oferta:</label>
                                    <input type="text" id="layout2-card2-title" class="field-input" placeholder="Investimentos">
                                </div>
                                <div class="field-group">
                                    <label for="layout2-card2-description">Descrição da Oferta:</label>
                                    <input type="text" id="layout2-card2-description" class="field-input" placeholder="Encontre sua aplicação">
                                </div>
                                <div class="field-group">
                                    <label for="layout2-card2-deeplink">Deeplink:</label>
                                    <input type="text" id="layout2-card2-deeplink" class="field-input" placeholder="URL do deeplink">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Campos do Layout 1 -->
                <div id="fields-layout-1" class="fields-section hidden">
                    
                    <div class="cards-container">
                        <div class="card-item">
                            <div class="card-title">Card Principal</div>
                            <div class="card-fields">
                                <div class="field-group">
                                    <label for="layout1-icon">Ícone:</label>
                                    <input type="text" id="layout1-icon" class="field-input" placeholder="🛡️">
                                </div>
                                <div class="field-group">
                                    <label for="layout1-title">Título da Oferta:</label>
                                    <input type="text" id="layout1-title" class="field-input" placeholder="Seguro Transações">
                                </div>
                                <div class="field-group">
                                    <label for="layout1-description">Descrição da Oferta:</label>
                                    <textarea id="layout1-description" class="field-input" placeholder="Proteção extra contra imprevistos para sua conta e cartão"></textarea>
                                </div>
                                
                                <div class="bullets-section">
                                    <div class="bullets-title">Bullets (até 3):</div>
                                    
                                    <div class="bullet-item">
                                        <div class="bullet-title">Bullet 1:</div>
                                        <div class="bullet-fields">
                                            <div class="field-group">
                                                <label for="layout1-bullet1-icon">Ícone:</label>
                                                <input type="text" id="layout1-bullet1-icon" class="field-input" placeholder="✓">
                                            </div>
                                            <div class="field-group">
                                                <label for="layout1-bullet1-text">Texto:</label>
                                                <input type="text" id="layout1-bullet1-text" class="field-input" placeholder="Roubo de itens pessoais até R$ 1,5 mil">
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="bullet-item">
                                        <div class="bullet-title">Bullet 2:</div>
                                        <div class="bullet-fields">
                                            <div class="field-group">
                                                <label for="layout1-bullet2-icon">Ícone:</label>
                                                <input type="text" id="layout1-bullet2-icon" class="field-input" placeholder="✓">
                                            </div>
                                            <div class="field-group">
                                                <label for="layout1-bullet2-text">Texto:</label>
                                                <input type="text" id="layout1-bullet2-text" class="field-input" placeholder="Furto e roubo após saque até R$ 1 mil">
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="bullet-item">
                                        <div class="bullet-title">Bullet 3:</div>
                                        <div class="bullet-fields">
                                            <div class="field-group">
                                                <label for="layout1-bullet3-icon">Ícone:</label>
                                                <input type="text" id="layout1-bullet3-icon" class="field-input" placeholder="✓">
                                            </div>
                                            <div class="field-group">
                                                <label for="layout1-bullet3-text">Texto:</label>
                                                <input type="text" id="layout1-bullet3-text" class="field-input" placeholder="Uso forçado de conta e cartão até R$ 10 mil">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="field-group">
                                    <label for="layout1-cta">Call to Action:</label>
                                    <input type="text" id="layout1-cta" class="field-input" placeholder="Contratar seguro">
                                </div>
                                <div class="field-group">
                                    <label for="layout1-deeplink">Deeplink:</label>
                                    <input type="text" id="layout1-deeplink" class="field-input" placeholder="URL do deeplink">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Campos do Layout 4 -->
                <div id="fields-layout-4" class="fields-section hidden">
                    
                    <div class="cards-container">
                        <div class="card-item">
                            <div class="card-title">Card 1 (Azul Marinho - Principal)</div>
                            <div class="card-fields">
                                <div class="field-group">
                                    <label for="layout4-card1-icon">Ícone:</label>
                                    <input type="text" id="layout4-card1-icon" class="field-input" placeholder="💰">
                                </div>
                                <div class="field-group">
                                    <label for="layout4-card1-title">Título da Oferta:</label>
                                    <input type="text" id="layout4-card1-title" class="field-input" placeholder="Previdência">
                                </div>
                                <div class="field-group">
                                    <label for="layout4-card1-description">Descrição da Oferta:</label>
                                    <input type="text" id="layout4-card1-description" class="field-input" placeholder="Um futuro mais tranquilo">
                                </div>
                                <div class="field-group">
                                    <label for="layout4-card1-deeplink">Deeplink:</label>
                                    <input type="text" id="layout4-card1-deeplink" class="field-input" placeholder="URL do deeplink">
                                </div>
                            </div>
                        </div>
                        
                        <div class="card-item">
                            <div class="card-title">Card 2 (Branco)</div>
                            <div class="card-fields">
                                <div class="field-group">
                                    <label for="layout4-card2-icon">Ícone:</label>
                                    <input type="text" id="layout4-card2-icon" class="field-input" placeholder="📊">
                                </div>
                                <div class="field-group">
                                    <label for="layout4-card2-title">Título da Oferta:</label>
                                    <input type="text" id="layout4-card2-title" class="field-input" placeholder="Investimentos">
                                </div>
                                <div class="field-group">
                                    <label for="layout4-card2-description">Descrição da Oferta:</label>
                                    <input type="text" id="layout4-card2-description" class="field-input" placeholder="Um futuro mais tranquilo">
                                </div>
                                <div class="field-group">
                                    <label for="layout4-card2-deeplink">Deeplink:</label>
                                    <input type="text" id="layout4-card2-deeplink" class="field-input" placeholder="URL do deeplink">
                                </div>
                            </div>
                        </div>
                        
                        <div class="card-item">
                            <div class="card-title">Card 3 (Branco)</div>
                            <div class="card-fields">
                                <div class="field-group">
                                    <label for="layout4-card3-icon">Ícone:</label>
                                    <input type="text" id="layout4-card3-icon" class="field-input" placeholder="🍀">
                                </div>
                                <div class="field-group">
                                    <label for="layout4-card3-title">Título da Oferta:</label>
                                    <input type="text" id="layout4-card3-title" class="field-input" placeholder="Cofrinhos">
                                </div>
                                <div class="field-group">
                                    <label for="layout4-card3-description">Descrição da Oferta:</label>
                                    <input type="text" id="layout4-card3-description" class="field-input" placeholder="Organize suas economias e realize seus planos">
                                </div>
                                <div class="field-group">
                                    <label for="layout4-card3-deeplink">Deeplink:</label>
                                    <input type="text" id="layout4-card3-deeplink" class="field-input" placeholder="URL do deeplink">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Campos do Layout 3 -->
                <div id="fields-layout-3" class="fields-section hidden">
                    
                    <div class="cards-container">
                        <div class="card-item">
                            <div class="card-title">Card 1 (Laranja - Principal)</div>
                            <div class="card-fields">
                                <div class="field-group">
                                    <label for="layout3-card1-icon">Ícone:</label>
                                    <input type="text" id="layout3-card1-icon" class="field-input" placeholder="📊">
                                </div>
                                <div class="field-group">
                                    <label for="layout3-card1-title">Título da Oferta:</label>
                                    <input type="text" id="layout3-card1-title" class="field-input" placeholder="Previdência">
                                </div>
                                <div class="field-group">
                                    <label for="layout3-card1-description">Descrição da Oferta:</label>
                                    <input type="text" id="layout3-card1-description" class="field-input" placeholder="Garanta um futuro tranquilo">
                                </div>
                                <div class="field-group">
                                    <label for="layout3-card1-deeplink">Deeplink:</label>
                                    <input type="text" id="layout3-card1-deeplink" class="field-input" placeholder="URL do deeplink">
                                </div>
                            </div>
                        </div>
                        
                        <div class="card-item">
                            <div class="card-title">Card 2 (Branco - Esquerdo)</div>
                            <div class="card-fields">
                                <div class="field-group">
                                    <label for="layout3-card2-icon">Ícone:</label>
                                    <input type="text" id="layout3-card2-icon" class="field-input" placeholder="📈">
                                </div>
                                <div class="field-group">
                                    <label for="layout3-card2-title">Título da Oferta:</label>
                                    <input type="text" id="layout3-card2-title" class="field-input" placeholder="Assessoria de investimentos">
                                </div>
                                <div class="field-group">
                                    <label for="layout3-card2-description">Descrição da Oferta:</label>
                                    <input type="text" id="layout3-card2-description" class="field-input" placeholder="Otimize o seurendimento">
                                </div>
                                <div class="field-group">
                                    <label for="layout3-card2-deeplink">Deeplink:</label>
                                    <input type="text" id="layout3-card2-deeplink" class="field-input" placeholder="URL do deeplink">
                                </div>
                            </div>
                        </div>
                        
                        <div class="card-item">
                            <div class="card-title">Card 3 (Branco - Direito)</div>
                            <div class="card-fields">
                                <div class="field-group">
                                    <label for="layout3-card3-icon">Ícone:</label>
                                    <input type="text" id="layout3-card3-icon" class="field-input" placeholder="💰">
                                </div>
                                <div class="field-group">
                                    <label for="layout3-card3-title">Título da Oferta:</label>
                                    <input type="text" id="layout3-card3-title" class="field-input" placeholder="Portabilidade de Investimentos">
                                </div>
                                <div class="field-group">
                                    <label for="layout3-card3-description">Descrição da Oferta:</label>
                                    <input type="text" id="layout3-card3-description" class="field-input" placeholder="Controle seus rendimentos no mesmo app">
                                </div>
                                <div class="field-group">
                                    <label for="layout3-card3-deeplink">Deeplink:</label>
                                    <input type="text" id="layout3-card3-deeplink" class="field-input" placeholder="URL do deeplink">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Seção Footer -->
            <div class="section">
                <h2>Footer</h2>
                <div class="field-group">
                    <label for="footer-title">Título do Footer:</label>
                    <input type="text" id="footer-title" class="field-input" placeholder="Título do footer" oninput="updateFooterPreview()">
                </div>
                
                <div class="card-item">
                    <div class="card-title">Card Footer (Laranja)</div>
                    <div class="card-fields">
                        <div class="field-group">
                            <label for="footer-card-title">Título da Oferta:</label>
                            <input type="text" id="footer-card-title" class="field-input" placeholder="Título da oferta" oninput="updateFooterPreview()">
                        </div>
                        <div class="field-group">
                            <label for="footer-card-description">Descrição da Oferta:</label>
                            <input type="text" id="footer-card-description" class="field-input" placeholder="Descrição da oferta" oninput="updateFooterPreview()">
                        </div>
                        <div class="field-group">
                            <label for="footer-card-deeplink">Deeplink:</label>
                            <input type="text" id="footer-card-deeplink" class="field-input" placeholder="URL do deeplink" oninput="updateFooterPreview()">
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Painel Direito - Preview -->
        <div class="right-panel">
            <div class="phone-container">
                <div class="phone-screen">
                    <div class="phone-header">
                        <span>20:05</span>
                        <span>●●●</span>
                    </div>
                    
                    <div class="phone-close">✕</div>
                    <div class="phone-avatar">👤</div>
                    
                    <div class="phone-content" id="phone-content">
                        <div class="phone-background-overlay" id="phone-background-overlay"></div>
                        
                        <div class="phone-initial-content">
                            <div class="phone-text" id="phone-text">
                                João, com base no seu perfil, preparamos estas ofertas especiais para você!
                            </div>
                        </div>
                        
                        <div class="phone-sticky-header">
                            <div class="phone-chips" id="phone-chips-header">
                                <div class="phone-chip">Interesse 1</div>
                                <div class="phone-chip">Interesse 2</div>
                            </div>
                        </div>
                        
                        <div class="phone-scrollable-content">
                            <div class="phone-offers" id="phone-offers">
                                <div class="preview-message">Configure uma categoria para ver o preview aqui</div>
                            </div>
                            
                            <div class="phone-footer" id="phone-footer">
                                <div class="footer-title" id="footer-title-preview">Título do Footer</div>
                                <div class="footer-card" id="footer-card-preview">
                                    <div class="footer-card-content">
                                        <div class="footer-card-title">Título da Oferta</div>
                                        <div class="footer-card-description">Descrição da Oferta</div>
                                    </div>
                                    <div class="footer-card-arrow">→</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentCategory = null;
        let currentLayout = null;
        let categoriesData = {};

        // Inicialização
        document.addEventListener('DOMContentLoaded', function() {
            setupEventListeners();
            setupScrollBehavior();
            updatePreview();
        });

        function setupEventListeners() {
            // Listeners para campos globais
            document.getElementById('background-image').addEventListener('input', updatePreview);
            document.getElementById('main-text').addEventListener('input', updatePreview);

            // Listeners para checkboxes das categorias
            ['credito', 'debito', 'beneficios', 'protecao'].forEach(category => {
                const checkbox = document.getElementById(`cat-${category}`);
                if (checkbox) {
                    checkbox.addEventListener('change', updatePreview);
                }
            });





            // Setup accordion functionality
            setupAccordions();
            setupDragAndDrop();
        }

        function setupAccordions() {
            // Setup accordion headers click
            document.querySelectorAll('.category-header').forEach(header => {
                header.addEventListener('click', function(e) {
                    // Don't trigger accordion if clicking on checkbox or drag handle
                    if (e.target.closest('.category-checkbox') || e.target.closest('.category-drag-handle')) {
                        return;
                    }
                    
                    const accordion = this.closest('.category-accordion');
                    const isExpanded = accordion.classList.contains('expanded');
                    
                    // Close all other accordions
                    document.querySelectorAll('.category-accordion.expanded').forEach(acc => {
                        if (acc !== accordion) {
                            acc.classList.remove('expanded');
                        }
                    });
                    
                    // Toggle current accordion
                    accordion.classList.toggle('expanded', !isExpanded);
                    
                    // Initialize layout options if opening
                    if (!isExpanded) {
                        const category = accordion.dataset.category;
                        initializeCategoryContent(category);
                    }
                });
            });

            // Initialize layout options for all categories immediately
            document.querySelectorAll('.category-accordion').forEach(accordion => {
                const category = accordion.dataset.category;
                initializeCategoryContent(category);
            });
        }

        function setupDragAndDrop() {
            const accordion = document.getElementById('categories-accordion');
            let draggedElement = null;

            // Add drag event listeners to each category
            document.querySelectorAll('.category-accordion').forEach(category => {
                // Set draggable only when mousedown on handle
                const handle = category.querySelector('.category-drag-handle');
                
                handle.addEventListener('mousedown', function() {
                    category.draggable = true;
                });
                
                category.addEventListener('mouseup', function() {
                    category.draggable = false;
                });
                
                category.addEventListener('mouseleave', function() {
                    category.draggable = false;
                });

                category.addEventListener('dragstart', function(e) {
                    draggedElement = this;
                    this.classList.add('dragging');
                    
                    // Set drag effect
                    e.dataTransfer.effectAllowed = 'move';
                    e.dataTransfer.setData('text/html', this.outerHTML);
                });

                category.addEventListener('dragend', function() {
                    this.classList.remove('dragging');
                    
                    // Always update preview when drag ends (regardless of successful drop)
                    setTimeout(() => {
                        updatePreview();
                    }, 100);
                    
                    draggedElement = null;
                    this.draggable = false;
                });

                category.addEventListener('dragover', function(e) {
                    e.preventDefault();
                    e.dataTransfer.dropEffect = 'move';
                    
                    // Add visual feedback
                    const afterElement = getDragAfterElement(accordion, e.clientY);
                    if (afterElement == null) {
                        accordion.appendChild(draggedElement);
                    } else {
                        accordion.insertBefore(draggedElement, afterElement);
                    }
                });

                category.addEventListener('drop', function(e) {
                    e.preventDefault();
                    
                    // Update preview order after drop
                    setTimeout(() => {
                        updatePreview();
                    }, 50);
                });
            });
        }

        function getDragAfterElement(container, y) {
            const draggableElements = [...container.querySelectorAll('.category-accordion:not(.dragging)')];
            
            return draggableElements.reduce((closest, child) => {
                const box = child.getBoundingClientRect();
                const offset = y - box.top - box.height / 2;
                
                if (offset < 0 && offset > closest.offset) {
                    return { offset: offset, element: child };
                } else {
                    return closest;
                }
            }, { offset: Number.NEGATIVE_INFINITY }).element;
        }

        function initializeCategoryContent(category) {
            console.log('initializeCategoryContent called for:', category);
            // Add layout option click listeners
            const accordion = document.querySelector(`[data-category="${category}"]`);
            const layoutOptions = accordion.querySelectorAll('.layout-option');
            console.log('Found layout options:', layoutOptions.length);
            
            layoutOptions.forEach((option, index) => {
                // Remove existing listener if any
                option.removeEventListener('click', option._clickHandler);
                
                // Create new click handler
                option._clickHandler = () => {
                    console.log('Layout option clicked:', category, index + 1);
                    selectCategoryLayout(category, index + 1);
                };
                option.addEventListener('click', option._clickHandler);
            });
        }

        function selectCategoryLayout(category, layoutNum) {
            console.log('selectCategoryLayout called:', category, layoutNum);
            
            // Update visual selection within the specific category accordion
            const accordion = document.querySelector(`[data-category="${category}"]`);
            console.log('accordion found:', accordion);
            
            if (!accordion) {
                console.error('Accordion not found for category:', category);
                return;
            }
            
            const layoutOptions = accordion.querySelectorAll('.layout-option');
            console.log('layoutOptions found:', layoutOptions.length);
            
            layoutOptions.forEach(option => {
                option.classList.remove('selected');
            });
            
            if (layoutOptions[layoutNum - 1]) {
                layoutOptions[layoutNum - 1].classList.add('selected');
            }
            
            // Store current category and layout
            currentCategory = category;
            currentLayout = `layout${layoutNum}`;
            
            // Initialize category data if needed
            if (!categoriesData[category]) {
                categoriesData[category] = {};
            }
            categoriesData[category].layout = currentLayout;
            
            // Show corresponding fields
            showLayoutFields(category, layoutNum);
            
            // Update status and preview
            updateCategoryStatus();
            updatePreview();
        }

        function showLayoutFields(category, layoutNum) {
            console.log('showLayoutFields called:', category, layoutNum);
            const fieldsContainer = document.getElementById(`fields-${category}`);
            console.log('fieldsContainer found:', fieldsContainer);
            
            if (!fieldsContainer) {
                console.error('Fields container not found for category:', category);
                return;
            }
            
            // Insert the actual layout fields that were in the original system
            switch(layoutNum) {
                case 1:
                    fieldsContainer.innerHTML = `
                        <div class="cards-container">
                            <div class="card-item">
                                <div class="card-title">Card Único</div>
                                <div class="card-fields">
                                    <div class="field-group">
                                        <label for="layout1-${category}-icon">Ícone:</label>
                                        <input type="text" id="layout1-${category}-icon" class="field-input" placeholder="📊" oninput="saveCurrentCategoryData(); updateCategoryStatus(); updatePreview();">
                                    </div>
                                    <div class="field-group">
                                        <label for="layout1-${category}-title">Título da Oferta:</label>
                                        <input type="text" id="layout1-${category}-title" class="field-input" placeholder="Previdência" oninput="saveCurrentCategoryData(); updateCategoryStatus(); updatePreview();">
                                    </div>
                                    <div class="field-group">
                                        <label for="layout1-${category}-description">Descrição da Oferta:</label>
                                        <input type="text" id="layout1-${category}-description" class="field-input" placeholder="Um futuro mais tranquilo" oninput="saveCurrentCategoryData(); updateCategoryStatus(); updatePreview();">
                                    </div>
                                    <div class="field-group">
                                        <label for="layout1-${category}-deeplink">Deeplink:</label>
                                        <input type="text" id="layout1-${category}-deeplink" class="field-input" placeholder="URL do deeplink" oninput="saveCurrentCategoryData(); updateCategoryStatus(); updatePreview();">
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                    break;
                case 2:
                    fieldsContainer.innerHTML = `
                        <div class="field-group">
                            <label for="layout2-${category}-title">Título da Categoria:</label>
                            <input type="text" id="layout2-${category}-title" class="field-input" placeholder="Título da categoria" disabled>
                        </div>
                        <div class="cards-container">
                            <div class="card-item">
                                <div class="card-title">Card 1 (Principal)</div>
                                <div class="card-fields">
                                    <div class="field-group">
                                        <label for="layout2-${category}-card1-bg">Imagem de Fundo:</label>
                                        <input type="text" id="layout2-${category}-card1-bg" class="field-input" placeholder="URL da imagem" oninput="saveCurrentCategoryData(); updateCategoryStatus(); updatePreview();">
                                    </div>
                                    <div class="field-group">
                                        <label for="layout2-${category}-card1-title">Título da Oferta:</label>
                                        <input type="text" id="layout2-${category}-card1-title" class="field-input" placeholder="Previdência" oninput="saveCurrentCategoryData(); updateCategoryStatus(); updatePreview();">
                                    </div>
                                    <div class="field-group">
                                        <label for="layout2-${category}-card1-description">Descrição da Oferta:</label>
                                        <input type="text" id="layout2-${category}-card1-description" class="field-input" placeholder="Um futuro mais tranquilo" oninput="saveCurrentCategoryData(); updateCategoryStatus(); updatePreview();">
                                    </div>
                                    <div class="field-group">
                                        <label for="layout2-${category}-card1-deeplink">Deeplink:</label>
                                        <input type="text" id="layout2-${category}-card1-deeplink" class="field-input" placeholder="URL do deeplink" oninput="saveCurrentCategoryData(); updateCategoryStatus(); updatePreview();">
                                    </div>
                                </div>
                            </div>
                            <div class="card-item">
                                <div class="card-title">Card 2 (Secundário)</div>
                                <div class="card-fields">
                                    <div class="field-group">
                                        <label for="layout2-${category}-card2-icon">Ícone:</label>
                                        <input type="text" id="layout2-${category}-card2-icon" class="field-input" placeholder="📈" oninput="saveCurrentCategoryData(); updateCategoryStatus(); updatePreview();">
                                    </div>
                                    <div class="field-group">
                                        <label for="layout2-${category}-card2-title">Título da Oferta:</label>
                                        <input type="text" id="layout2-${category}-card2-title" class="field-input" placeholder="Investimentos" oninput="saveCurrentCategoryData(); updateCategoryStatus(); updatePreview();">
                                    </div>
                                    <div class="field-group">
                                        <label for="layout2-${category}-card2-description">Descrição da Oferta:</label>
                                        <input type="text" id="layout2-${category}-card2-description" class="field-input" placeholder="Rentabilidade garantida" oninput="saveCurrentCategoryData(); updateCategoryStatus(); updatePreview();">
                                    </div>
                                    <div class="field-group">
                                        <label for="layout2-${category}-card2-deeplink">Deeplink:</label>
                                        <input type="text" id="layout2-${category}-card2-deeplink" class="field-input" placeholder="URL do deeplink" oninput="saveCurrentCategoryData(); updateCategoryStatus(); updatePreview();">
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                    break;
                case 3:
                    fieldsContainer.innerHTML = `
                        <div class="cards-container">
                            <div class="card-item">
                                <div class="card-title">Card 1 (Laranja - Principal)</div>
                                <div class="card-fields">
                                    <div class="field-group">
                                        <label for="layout3-${category}-card1-icon">Ícone:</label>
                                        <input type="text" id="layout3-${category}-card1-icon" class="field-input" placeholder="📊" oninput="saveCurrentCategoryData(); updateCategoryStatus(); updatePreview();">
                                    </div>
                                    <div class="field-group">
                                        <label for="layout3-${category}-card1-title">Título da Oferta:</label>
                                        <input type="text" id="layout3-${category}-card1-title" class="field-input" placeholder="Previdência" oninput="saveCurrentCategoryData(); updateCategoryStatus(); updatePreview();">
                                    </div>
                                    <div class="field-group">
                                        <label for="layout3-${category}-card1-description">Descrição da Oferta:</label>
                                        <input type="text" id="layout3-${category}-card1-description" class="field-input" placeholder="Garanta um futuro tranquilo" oninput="saveCurrentCategoryData(); updateCategoryStatus(); updatePreview();">
                                    </div>
                                    <div class="field-group">
                                        <label for="layout3-${category}-card1-deeplink">Deeplink:</label>
                                        <input type="text" id="layout3-${category}-card1-deeplink" class="field-input" placeholder="URL do deeplink" oninput="saveCurrentCategoryData(); updateCategoryStatus(); updatePreview();">
                                    </div>
                                </div>
                            </div>
                            
                            <div class="card-item">
                                <div class="card-title">Card 2 (Branco - Esquerdo)</div>
                                <div class="card-fields">
                                    <div class="field-group">
                                        <label for="layout3-${category}-card2-icon">Ícone:</label>
                                        <input type="text" id="layout3-${category}-card2-icon" class="field-input" placeholder="📈" oninput="saveCurrentCategoryData(); updateCategoryStatus(); updatePreview();">
                                    </div>
                                    <div class="field-group">
                                        <label for="layout3-${category}-card2-title">Título da Oferta:</label>
                                        <input type="text" id="layout3-${category}-card2-title" class="field-input" placeholder="Assessoria de investimentos" oninput="saveCurrentCategoryData(); updateCategoryStatus(); updatePreview();">
                                    </div>
                                    <div class="field-group">
                                        <label for="layout3-${category}-card2-description">Descrição da Oferta:</label>
                                        <input type="text" id="layout3-${category}-card2-description" class="field-input" placeholder="Otimize o seu rendimento" oninput="saveCurrentCategoryData(); updateCategoryStatus(); updatePreview();">
                                    </div>
                                    <div class="field-group">
                                        <label for="layout3-${category}-card2-deeplink">Deeplink:</label>
                                        <input type="text" id="layout3-${category}-card2-deeplink" class="field-input" placeholder="URL do deeplink" oninput="saveCurrentCategoryData(); updateCategoryStatus(); updatePreview();">
                                    </div>
                                </div>
                            </div>

                            <div class="card-item">
                                <div class="card-title">Card 3 (Branco - Direito)</div>
                                <div class="card-fields">
                                    <div class="field-group">
                                        <label for="layout3-${category}-card3-icon">Ícone:</label>
                                        <input type="text" id="layout3-${category}-card3-icon" class="field-input" placeholder="📊" oninput="saveCurrentCategoryData(); updateCategoryStatus(); updatePreview();">
                                    </div>
                                    <div class="field-group">
                                        <label for="layout3-${category}-card3-title">Título da Oferta:</label>
                                        <input type="text" id="layout3-${category}-card3-title" class="field-input" placeholder="Conta Itaú" oninput="saveCurrentCategoryData(); updateCategoryStatus(); updatePreview();">
                                    </div>
                                    <div class="field-group">
                                        <label for="layout3-${category}-card3-description">Descrição da Oferta:</label>
                                        <input type="text" id="layout3-${category}-card3-description" class="field-input" placeholder="Controle seus rendimentos no mesmo app" oninput="saveCurrentCategoryData(); updateCategoryStatus(); updatePreview();">
                                    </div>
                                    <div class="field-group">
                                        <label for="layout3-${category}-card3-deeplink">Deeplink:</label>
                                        <input type="text" id="layout3-${category}-card3-deeplink" class="field-input" placeholder="URL do deeplink" oninput="saveCurrentCategoryData(); updateCategoryStatus(); updatePreview();">
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                    break;
                case 4:
                    fieldsContainer.innerHTML = `
                        <div class="cards-container">
                            <div class="card-item">
                                <div class="card-title">Card 1 (Principal)</div>
                                <div class="card-fields">
                                    <div class="field-group">
                                        <label for="layout4-${category}-card1-icon">Ícone:</label>
                                        <input type="text" id="layout4-${category}-card1-icon" class="field-input" placeholder="💰" oninput="saveCurrentCategoryData(); updateCategoryStatus(); updatePreview();">
                                    </div>
                                    <div class="field-group">
                                        <label for="layout4-${category}-card1-title">Título da Oferta:</label>
                                        <input type="text" id="layout4-${category}-card1-title" class="field-input" placeholder="Previdência" oninput="saveCurrentCategoryData(); updateCategoryStatus(); updatePreview();">
                                    </div>
                                    <div class="field-group">
                                        <label for="layout4-${category}-card1-description">Descrição da Oferta:</label>
                                        <input type="text" id="layout4-${category}-card1-description" class="field-input" placeholder="Um futuro mais tranquilo" oninput="saveCurrentCategoryData(); updateCategoryStatus(); updatePreview();">
                                    </div>
                                    <div class="field-group">
                                        <label for="layout4-${category}-card1-deeplink">Deeplink:</label>
                                        <input type="text" id="layout4-${category}-card1-deeplink" class="field-input" placeholder="URL do deeplink" oninput="saveCurrentCategoryData(); updateCategoryStatus(); updatePreview();">
                                    </div>
                                </div>
                            </div>
                            
                            <div class="card-item">
                                <div class="card-title">Card 2</div>
                                <div class="card-fields">
                                    <div class="field-group">
                                        <label for="layout4-${category}-card2-icon">Ícone:</label>
                                        <input type="text" id="layout4-${category}-card2-icon" class="field-input" placeholder="📊" oninput="saveCurrentCategoryData(); updateCategoryStatus(); updatePreview();">
                                    </div>
                                    <div class="field-group">
                                        <label for="layout4-${category}-card2-title">Título da Oferta:</label>
                                        <input type="text" id="layout4-${category}-card2-title" class="field-input" placeholder="Investimentos" oninput="saveCurrentCategoryData(); updateCategoryStatus(); updatePreview();">
                                    </div>
                                    <div class="field-group">
                                        <label for="layout4-${category}-card2-description">Descrição da Oferta:</label>
                                        <input type="text" id="layout4-${category}-card2-description" class="field-input" placeholder="Um futuro mais tranquilo" oninput="saveCurrentCategoryData(); updateCategoryStatus(); updatePreview();">
                                    </div>
                                    <div class="field-group">
                                        <label for="layout4-${category}-card2-deeplink">Deeplink:</label>
                                        <input type="text" id="layout4-${category}-card2-deeplink" class="field-input" placeholder="URL do deeplink" oninput="saveCurrentCategoryData(); updateCategoryStatus(); updatePreview();">
                                    </div>
                                </div>
                            </div>

                            <div class="card-item">
                                <div class="card-title">Card 3</div>
                                <div class="card-fields">
                                    <div class="field-group">
                                        <label for="layout4-${category}-card3-icon">Ícone:</label>
                                        <input type="text" id="layout4-${category}-card3-icon" class="field-input" placeholder="🍀" oninput="saveCurrentCategoryData(); updateCategoryStatus(); updatePreview();">
                                    </div>
                                    <div class="field-group">
                                        <label for="layout4-${category}-card3-title">Título da Oferta:</label>
                                        <input type="text" id="layout4-${category}-card3-title" class="field-input" placeholder="Cofrinhos" oninput="saveCurrentCategoryData(); updateCategoryStatus(); updatePreview();">
                                    </div>
                                    <div class="field-group">
                                        <label for="layout4-${category}-card3-description">Descrição da Oferta:</label>
                                        <input type="text" id="layout4-${category}-card3-description" class="field-input" placeholder="Organize suas economias e realize seus planos" oninput="saveCurrentCategoryData(); updateCategoryStatus(); updatePreview();">
                                    </div>
                                    <div class="field-group">
                                        <label for="layout4-${category}-card3-deeplink">Deeplink:</label>
                                        <input type="text" id="layout4-${category}-card3-deeplink" class="field-input" placeholder="URL do deeplink" oninput="saveCurrentCategoryData(); updateCategoryStatus(); updatePreview();">
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                    break;
                default:
                    fieldsContainer.innerHTML = `<p>Layout ${layoutNum} em desenvolvimento...</p>`;
            }
        }

        function setupScrollBehavior() {
            const phoneContent = document.getElementById('phone-content');
            const phoneText = document.getElementById('phone-text');
            const phoneBackground = document.getElementById('phone-background-overlay');
            const phoneAvatar = document.querySelector('.phone-avatar');
            const phoneStickyHeader = document.querySelector('.phone-sticky-header');
            const phoneInitialContent = document.querySelector('.phone-initial-content');
            
            phoneContent.addEventListener('scroll', function() {
                const scrollTop = phoneContent.scrollTop;
                const initialContentHeight = phoneInitialContent.offsetHeight;
                
                // Hide main text, background and avatar when scrolling starts
                // Keep close button visible, move sticky header to top when scrolling
                if (scrollTop > 0) {
                    phoneText.classList.add('hidden-on-scroll');
                    phoneBackground.classList.add('hidden-on-scroll');
                    phoneAvatar.classList.add('hidden-on-scroll');
                    phoneStickyHeader.classList.add('scrolled');
                } else {
                    phoneText.classList.remove('hidden-on-scroll');
                    phoneBackground.classList.remove('hidden-on-scroll');
                    phoneAvatar.classList.remove('hidden-on-scroll');
                    phoneStickyHeader.classList.remove('scrolled');
                }
            });
        }

        function configureCategory(category) {
            currentCategory = category;
            
            // Atualizar título
            const categoryNames = {
                'credito': 'Crédito',
                'debito': 'Débito',
                'beneficios': 'Benefícios',
                'protecao': 'Proteção'
            };
            
            document.getElementById('config-title').textContent = `Configurando: ${categoryNames[category]}`;
            
            // Mostrar seção de configuração
            document.getElementById('active-config').classList.remove('hidden');
            
            // Limpar seleção de layout anterior
            document.querySelectorAll('.layout-option').forEach(option => {
                option.classList.remove('selected');
            });
            
            // Esconder todos os campos
            document.querySelectorAll('.fields-section').forEach(section => {
                section.classList.add('hidden');
            });
            
            // Se já existe configuração para esta categoria, restaurar
            if (categoriesData[category]) {
                selectLayout(categoriesData[category].layout);
                populateFields(categoriesData[category].layout, categoriesData[category].data);
            }
        }

        function cancelConfiguration() {
            currentCategory = null;
            currentLayout = null;
            document.getElementById('active-config').classList.add('hidden');
        }

        function selectLayout(layout) {
            currentLayout = layout;
            
            // Atualizar seleção visual
            document.querySelectorAll('.layout-option').forEach(option => {
                option.classList.remove('selected');
            });
            document.querySelector(`.layout-${layout}`).classList.add('selected');
            
            // Esconder todos os campos
            document.querySelectorAll('.fields-section').forEach(section => {
                section.classList.add('hidden');
            });
            
            // Mostrar campos do layout selecionado
            const fieldsSection = document.getElementById(`fields-layout-${layout}`);
            if (fieldsSection) {
                fieldsSection.classList.remove('hidden');
            }
            
            // Salvar layout na categoria atual
            if (currentCategory) {
                if (!categoriesData[currentCategory]) {
                    categoriesData[currentCategory] = { layout: layout, data: {} };
                } else {
                    categoriesData[currentCategory].layout = layout;
                }
                
                // Carregar dados existentes se houver
                if (categoriesData[currentCategory].data) {
                    populateFields(layout, categoriesData[currentCategory].data);
                }
            }
        }

        function saveCurrentCategoryData() {
            if (!currentCategory || !currentLayout) return;
            
            const data = collectFieldData(currentLayout);
            
            if (!categoriesData[currentCategory]) {
                categoriesData[currentCategory] = { layout: currentLayout, data: {} };
            }
            
            categoriesData[currentCategory].data = data;
        }

        function collectFieldData(layout) {
            const layoutNum = parseInt(layout.replace('layout', ''));
            
            switch (layoutNum) {
                case 1:
                    return {
                        icon: document.getElementById(`layout1-${currentCategory}-icon`)?.value || '',
                        title: document.getElementById(`layout1-${currentCategory}-title`)?.value || '',
                        description: document.getElementById(`layout1-${currentCategory}-description`)?.value || '',
                        deeplink: document.getElementById(`layout1-${currentCategory}-deeplink`)?.value || ''
                    };
                case 2:
                    return {
                        card1: {
                            bg: document.getElementById(`layout2-${currentCategory}-card1-bg`)?.value || '',
                            title: document.getElementById(`layout2-${currentCategory}-card1-title`)?.value || '',
                            description: document.getElementById(`layout2-${currentCategory}-card1-description`)?.value || '',
                            deeplink: document.getElementById(`layout2-${currentCategory}-card1-deeplink`)?.value || ''
                        },
                        card2: {
                            icon: document.getElementById(`layout2-${currentCategory}-card2-icon`)?.value || '',
                            title: document.getElementById(`layout2-${currentCategory}-card2-title`)?.value || '',
                            description: document.getElementById(`layout2-${currentCategory}-card2-description`)?.value || '',
                            deeplink: document.getElementById(`layout2-${currentCategory}-card2-deeplink`)?.value || ''
                        }
                    };
                case 3:
                    return {
                        card1: {
                            icon: document.getElementById(`layout3-${currentCategory}-card1-icon`)?.value || '',
                            title: document.getElementById(`layout3-${currentCategory}-card1-title`)?.value || '',
                            description: document.getElementById(`layout3-${currentCategory}-card1-description`)?.value || '',
                            deeplink: document.getElementById(`layout3-${currentCategory}-card1-deeplink`)?.value || ''
                        },
                        card2: {
                            icon: document.getElementById(`layout3-${currentCategory}-card2-icon`)?.value || '',
                            title: document.getElementById(`layout3-${currentCategory}-card2-title`)?.value || '',
                            description: document.getElementById(`layout3-${currentCategory}-card2-description`)?.value || '',
                            deeplink: document.getElementById(`layout3-${currentCategory}-card2-deeplink`)?.value || ''
                        },
                        card3: {
                            icon: document.getElementById(`layout3-${currentCategory}-card3-icon`)?.value || '',
                            title: document.getElementById(`layout3-${currentCategory}-card3-title`)?.value || '',
                            description: document.getElementById(`layout3-${currentCategory}-card3-description`)?.value || '',
                            deeplink: document.getElementById(`layout3-${currentCategory}-card3-deeplink`)?.value || ''
                        }
                    };
                case 4:
                    return {
                        card1: {
                            icon: document.getElementById(`layout4-${currentCategory}-card1-icon`)?.value || '',
                            title: document.getElementById(`layout4-${currentCategory}-card1-title`)?.value || '',
                            description: document.getElementById(`layout4-${currentCategory}-card1-description`)?.value || '',
                            deeplink: document.getElementById(`layout4-${currentCategory}-card1-deeplink`)?.value || ''
                        },
                        card2: {
                            icon: document.getElementById(`layout4-${currentCategory}-card2-icon`)?.value || '',
                            title: document.getElementById(`layout4-${currentCategory}-card2-title`)?.value || '',
                            description: document.getElementById(`layout4-${currentCategory}-card2-description`)?.value || '',
                            deeplink: document.getElementById(`layout4-${currentCategory}-card2-deeplink`)?.value || ''
                        },
                        card3: {
                            icon: document.getElementById(`layout4-${currentCategory}-card3-icon`)?.value || '',
                            title: document.getElementById(`layout4-${currentCategory}-card3-title`)?.value || '',
                            description: document.getElementById(`layout4-${currentCategory}-card3-description`)?.value || '',
                            deeplink: document.getElementById(`layout4-${currentCategory}-card3-deeplink`)?.value || ''
                        }
                    };
                default:
                    return {};
            }
        }

        function populateFields(layout, data) {
            const layoutNum = layout.replace('layout', '');
            switch (layoutNum) {
                case '1':
                    if (data.categoryTitle !== undefined) {
                    }
                    document.getElementById(`layout1-${currentCategory}-icon`).value = data.icon || '';
                    document.getElementById(`layout1-${currentCategory}-title`).value = data.title || '';
                    document.getElementById(`layout1-${currentCategory}-description`).value = data.description || '';
                    if (data.bullets && data.bullets.length > 0) {
                        document.getElementById(`layout1-${currentCategory}-bullet1-icon`).value = data.bullets[0]?.icon || '';
                        document.getElementById(`layout1-${currentCategory}-bullet1-text`).value = data.bullets[0]?.text || '';
                    }
                    if (data.bullets && data.bullets.length > 1) {
                        document.getElementById(`layout1-${currentCategory}-bullet2-icon`).value = data.bullets[1]?.icon || '';
                        document.getElementById(`layout1-${currentCategory}-bullet2-text`).value = data.bullets[1]?.text || '';
                    }
                    if (data.bullets && data.bullets.length > 2) {
                        document.getElementById(`layout1-${currentCategory}-bullet3-icon`).value = data.bullets[2]?.icon || '';
                        document.getElementById(`layout1-${currentCategory}-bullet3-text`).value = data.bullets[2]?.text || '';
                    }
                    document.getElementById(`layout1-${currentCategory}-cta`).value = data.cta || '';
                    document.getElementById(`layout1-${currentCategory}-deeplink`).value = data.deeplink || '';
                    break;
                case '4':
                    if (data.card1) {
                        document.getElementById(`layout4-${currentCategory}-card1-icon`).value = data.card1.icon || '';
                        document.getElementById(`layout4-${currentCategory}-card1-title`).value = data.card1.title || '';
                        document.getElementById(`layout4-${currentCategory}-card1-description`).value = data.card1.description || '';
                        document.getElementById(`layout4-${currentCategory}-card1-deeplink`).value = data.card1.deeplink || '';
                    }
                    if (data.card2) {
                        document.getElementById(`layout4-${currentCategory}-card2-icon`).value = data.card2.icon || '';
                        document.getElementById(`layout4-${currentCategory}-card2-title`).value = data.card2.title || '';
                        document.getElementById(`layout4-${currentCategory}-card2-description`).value = data.card2.description || '';
                        document.getElementById(`layout4-${currentCategory}-card2-deeplink`).value = data.card2.deeplink || '';
                    }
                    if (data.card3) {
                        document.getElementById(`layout4-${currentCategory}-card3-icon`).value = data.card3.icon || '';
                        document.getElementById(`layout4-${currentCategory}-card3-title`).value = data.card3.title || '';
                        document.getElementById(`layout4-${currentCategory}-card3-description`).value = data.card3.description || '';
                        document.getElementById(`layout4-${currentCategory}-card3-deeplink`).value = data.card3.deeplink || '';
                    }
                    break;
                case '2':
                    if (data.card1) {
                        document.getElementById(`layout2-${currentCategory}-card1-bg`).value = data.card1.bg || '';
                        document.getElementById(`layout2-${currentCategory}-card1-title`).value = data.card1.title || '';
                        document.getElementById(`layout2-${currentCategory}-card1-description`).value = data.card1.description || '';
                        document.getElementById(`layout2-${currentCategory}-card1-deeplink`).value = data.card1.deeplink || '';
                    }
                    if (data.card2) {
                        document.getElementById(`layout2-${currentCategory}-card2-icon`).value = data.card2.icon || '';
                        document.getElementById(`layout2-${currentCategory}-card2-title`).value = data.card2.title || '';
                        document.getElementById(`layout2-${currentCategory}-card2-description`).value = data.card2.description || '';
                        document.getElementById(`layout2-${currentCategory}-card2-deeplink`).value = data.card2.deeplink || '';
                    }
                    break;
                case '3':
                    if (data.categoryTitle !== undefined) {
                    }
                    if (data.card1) {
                        document.getElementById(`layout3-${currentCategory}-card1-icon`).value = data.card1.icon || '';
                        document.getElementById(`layout3-${currentCategory}-card1-title`).value = data.card1.title || '';
                        document.getElementById(`layout3-${currentCategory}-card1-description`).value = data.card1.description || '';
                        document.getElementById(`layout3-${currentCategory}-card1-deeplink`).value = data.card1.deeplink || '';
                    }
                    if (data.card2) {
                        document.getElementById(`layout3-${currentCategory}-card2-icon`).value = data.card2.icon || '';
                        document.getElementById(`layout3-${currentCategory}-card2-title`).value = data.card2.title || '';
                        document.getElementById(`layout3-${currentCategory}-card2-description`).value = data.card2.description || '';
                        document.getElementById(`layout3-${currentCategory}-card2-deeplink`).value = data.card2.deeplink || '';
                    }
                    if (data.card3) {
                        document.getElementById(`layout3-${currentCategory}-card3-icon`).value = data.card3.icon || '';
                        document.getElementById(`layout3-${currentCategory}-card3-title`).value = data.card3.title || '';
                        document.getElementById(`layout3-${currentCategory}-card3-description`).value = data.card3.description || '';
                        document.getElementById(`layout3-${currentCategory}-card3-deeplink`).value = data.card3.deeplink || '';
                    }
                    break;
            }
        }

        function updateCategoryStatus() {
            Object.keys(categoriesData).forEach(category => {
                const statusElement = document.getElementById(`status-${category}`);
                const data = categoriesData[category];
                
                if (data && isLayoutComplete(data.layout, data.data)) {
                    statusElement.textContent = 'Configurado';
                    statusElement.className = 'status-badge configured';
                } else {
                    statusElement.textContent = 'Vazio';
                    statusElement.className = 'status-badge empty';
                }
            });
        }

        function isLayoutComplete(layout, data) {
            switch (layout) {
                case 1:
                    if (!data.icon || !data.icon.trim()) return false;
                    if (!data.title || !data.title.trim()) return false;
                    if (!data.description || !data.description.trim()) return false;
                    if (!data.cta || !data.cta.trim()) return false;
                    // Pelo menos 1 bullet deve estar preenchido
                    const validBullets = data.bullets?.filter(bullet => 
                        bullet.icon && bullet.icon.trim() && bullet.text && bullet.text.trim()
                    ) || [];
                    if (validBullets.length === 0) return false;
                    return true;
                case 4:
                    if (!data.card1?.icon || !data.card1.icon.trim()) return false;
                    if (!data.card1?.title || !data.card1.title.trim()) return false;
                    if (!data.card1?.description || !data.card1.description.trim()) return false;
                    if (!data.card2?.icon || !data.card2.icon.trim()) return false;
                    if (!data.card2?.title || !data.card2.title.trim()) return false;
                    if (!data.card2?.description || !data.card2.description.trim()) return false;
                    if (!data.card3?.icon || !data.card3.icon.trim()) return false;
                    if (!data.card3?.title || !data.card3.title.trim()) return false;
                    if (!data.card3?.description || !data.card3.description.trim()) return false;
                    return true;
                case 2:
                    if (!data.card1?.title || !data.card1.title.trim()) return false;
                    if (!data.card1?.description || !data.card1.description.trim()) return false;
                    if (!data.card2?.icon || !data.card2.icon.trim()) return false;
                    if (!data.card2?.title || !data.card2.title.trim()) return false;
                    if (!data.card2?.description || !data.card2.description.trim()) return false;
                    return true;
                case 3:
                    if (!data.card1?.icon || !data.card1.icon.trim()) return false;
                    if (!data.card1?.title || !data.card1.title.trim()) return false;
                    if (!data.card1?.description || !data.card1.description.trim()) return false;
                    if (!data.card2?.icon || !data.card2.icon.trim()) return false;
                    if (!data.card2?.title || !data.card2.title.trim()) return false;
                    if (!data.card2?.description || !data.card2.description.trim()) return false;
                    if (!data.card3?.icon || !data.card3.icon.trim()) return false;
                    if (!data.card3?.title || !data.card3.title.trim()) return false;
                    if (!data.card3?.description || !data.card3.description.trim()) return false;
                    return true;
                default:
                    return false;
            }
        }

        function updatePreview() {
            // Atualizar background
            const backgroundImage = document.getElementById('background-image').value;
            const backgroundOverlay = document.getElementById('phone-background-overlay');
            if (backgroundImage) {
                backgroundOverlay.style.backgroundImage = `url('${backgroundImage}')`;
            } else {
                backgroundOverlay.style.backgroundImage = '';
            }

            // Atualizar texto principal
            const mainText = document.getElementById('main-text').value || 'João, com base no seu perfil, preparamos estas ofertas especiais para você!';
            document.getElementById('phone-text').textContent = mainText;

            // Atualizar chips das categorias
            updateCategoryChips();
            
            // Atualizar ofertas
            updateOffersPreview();
        }

        function updateCategoryChips() {
            console.log('updateCategoryChips called');
            const chipsContainer = document.getElementById('phone-chips-header');
            chipsContainer.innerHTML = '';

            // Mapear nomes das categorias
            const categoryNames = {
                'credito': 'Crédito',
                'debito': 'Débito', 
                'beneficios': 'Benefícios',
                'protecao': 'Proteção'
            };

            // Verificar quais categorias estão marcadas (checkboxes) na ordem do accordion
            const selectedCategories = [];
            const accordionCategories = [...document.querySelectorAll('.category-accordion')].map(acc => acc.dataset.category);
            console.log('accordion order:', accordionCategories);
            
            accordionCategories.forEach(category => {
                const checkbox = document.getElementById(`cat-${category}`);
                if (checkbox && checkbox.checked) {
                    selectedCategories.push(category);
                }
            });
            
            console.log('selected categories in order:', selectedCategories);

            // Mostrar chips das categorias selecionadas
            selectedCategories.forEach(category => {
                const chip = document.createElement('div');
                const data = categoriesData[category];
                const isConfigured = data && isLayoutComplete(data.layout, data.data);
                
                chip.className = isConfigured ? 'phone-chip active' : 'phone-chip';
                chip.textContent = categoryNames[category] || category;
                chip.dataset.category = category;
                chip.style.cursor = 'pointer';
                
                // Adicionar event listener para clique
                chip.addEventListener('click', function() {
                    handleChipClick(category, chip);
                });
                
                chipsContainer.appendChild(chip);
            });

            // Se não há categorias selecionadas, mostrar chips padrão
            if (selectedCategories.length === 0) {
                const chip1 = document.createElement('div');
                chip1.className = 'phone-chip';
                chip1.textContent = 'Interesse 1';
                chipsContainer.appendChild(chip1);

                const chip2 = document.createElement('div');
                chip2.className = 'phone-chip';
                chip2.textContent = 'Interesse 2';
                chipsContainer.appendChild(chip2);
            }
            
            // Sempre adicionar o chip de edição no final
            const editChip = document.createElement('div');
            editChip.className = 'phone-chip edit';
            editChip.innerHTML = `
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M17 3C17.2626 2.73735 17.5744 2.52901 17.9176 2.38687C18.2608 2.24473 18.6286 2.17157 19 2.17157C19.3714 2.17157 19.7392 2.24473 20.0824 2.38687C20.4256 2.52901 20.7374 2.73735 21 3C21.2626 3.26264 21.471 3.57444 21.6131 3.9176C21.7553 4.26077 21.8284 4.62856 21.8284 5C21.8284 5.37143 21.7553 5.73923 21.6131 6.08239C21.471 6.42555 21.2626 6.73735 21 7L7.5 20.5L2 22L3.5 16.5L17 3Z" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
            `;
            chipsContainer.appendChild(editChip);
        }

        function handleChipClick(category, clickedChip) {
            // Remover seleção de todos os chips
            document.querySelectorAll('.phone-chip').forEach(chip => {
                chip.classList.remove('selected');
            });
            
            // Adicionar seleção ao chip clicado
            clickedChip.classList.add('selected');
            
            // Fazer scroll para a seção da categoria correspondente
            const categorySection = document.querySelector(`[data-category-section="${category}"]`);
            const phoneContent = document.getElementById('phone-content');
            
            if (categorySection && phoneContent) {
                // Encontrar o título da categoria para calcular onde ficam os cards
                const categoryTitle = categorySection.querySelector('.layout1-title, .layout2-title, .layout3-title, .layout4-title');
                
                // Se encontrou o título, fazer scroll para mostrá-lo junto com os cards
                if (categoryTitle) {
                    const titleRect = categoryTitle.getBoundingClientRect();
                    const phoneRect = phoneContent.getBoundingClientRect();
                    const currentScroll = phoneContent.scrollTop;
                    
                    // Posição do título relativa ao topo do container + scroll atual
                    const titlePosition = titleRect.top - phoneRect.top + currentScroll;
                    
                    // Scroll para mostrar o título com um pequeno padding superior (30px)
                    const targetPosition = titlePosition - 30;
                    
                    phoneContent.scrollTo({
                        top: targetPosition,
                        behavior: 'smooth'
                    });
                } else {
                    // Fallback: scroll para o início da seção
                    categorySection.scrollIntoView({ 
                        behavior: 'smooth', 
                        block: 'start' 
                    });
                }
            }
        }

        function updateOffersPreview() {
            const offersContainer = document.getElementById('phone-offers');
            offersContainer.innerHTML = '';

            let hasOffers = false;

            // Get categories in the order they appear in the accordion (after drag/drop)
            const accordionCategories = [...document.querySelectorAll('.category-accordion')].map(acc => acc.dataset.category);

            // Verificar quais categorias estão marcadas (checkboxes) na ordem do accordion
            accordionCategories.forEach(category => {
                const checkbox = document.getElementById(`cat-${category}`);
                const data = categoriesData[category];
                
                // Mostrar se a categoria está marcada E tem um layout selecionado
                if (checkbox && checkbox.checked && data && data.layout) {
                    hasOffers = true;
                    
                    // Mapear nomes das categorias
                    const categoryNames = {
                        'credito': 'Crédito',
                        'debito': 'Débito', 
                        'beneficios': 'Benefícios',
                        'protecao': 'Proteção'
                    };
                    
                    // Criar seção da categoria com data attribute
                    const categorySection = document.createElement('div');
                    categorySection.setAttribute('data-category-section', category);
                    categorySection.style.marginBottom = '24px';
                    
                    // Adicionar o conteúdo da oferta
                    const offerContent = document.createElement('div');
                    offerContent.innerHTML = generateOfferPreviewWithPlaceholders(data.layout, data.data || {}, category);
                    categorySection.appendChild(offerContent);
                    
                    offersContainer.appendChild(categorySection);
                }
            });

            if (!hasOffers) {
                offersContainer.innerHTML = '<div class="preview-message">Configure uma categoria para ver o preview aqui</div>';
            }
        }

        function generateOfferPreviewWithPlaceholders(layout, data, category) {
            const layoutNum = parseInt(layout.replace('layout', ''));
            
            switch (layoutNum) {
                case 1:
                    return generateLayout1PreviewWithPlaceholders(data, category);
                case 2:
                    return generateLayout2PreviewWithPlaceholders(data, category);
                case 3:
                    return generateLayout3PreviewWithPlaceholders(data, category);
                case 4:
                    return generateLayout4PreviewWithPlaceholders(data, category);
                default:
                    return '<div class="preview-message">Layout em desenvolvimento</div>';
            }
        }

        function generateLayout1PreviewWithPlaceholders(data, category) {
            const categoryNames = {
                'credito': 'Crédito',
                'debito': 'Débito', 
                'beneficios': 'Benefícios',
                'protecao': 'Proteção'
            };
            const categoryTitle = categoryNames[category] || category;
            const icon = data.icon || '📊';
            const title = data.title || 'Título da Oferta';
            const description = data.description || 'Descrição da oferta';
            
            return `
                <div class="layout1-container">
                    <div class="layout1-title">${categoryTitle}</div>
                    <div class="layout1-card">
                        <div class="layout1-card-icon">${icon}</div>
                        <div class="layout1-card-content">
                            <div class="layout1-card-title">${title}</div>
                            <div class="layout1-card-description">${description}</div>
                        </div>
                        <div class="layout1-card-arrow">›</div>
                    </div>
                </div>
            `;
        }

        function generateLayout2PreviewWithPlaceholders(data, category) {
            const categoryNames = {
                'credito': 'Crédito',
                'debito': 'Débito', 
                'beneficios': 'Benefícios',
                'protecao': 'Proteção'
            };

            const categoryTitle = categoryNames[category] || category;
            const card1Bg = data.card1?.bg || '';
            const card1Title = data.card1?.title || 'Título da Oferta';
            const card1Description = data.card1?.description || 'Descrição da oferta';
            const card2Icon = data.card2?.icon || '📈';
            const card2Title = data.card2?.title || 'Título da Oferta';
            const card2Description = data.card2?.description || 'Descrição da oferta';

            return `
                <div class="layout2-container">
                    <div class="layout2-title">${categoryTitle}</div>
                    <div class="layout2-content">
                        <div class="layout2-card1" ${card1Bg ? `style="background-image: url('${card1Bg}')"` : ''}>
                            <div class="layout2-card1-content">
                                <div class="layout2-card1-title">${card1Title}</div>
                                <div class="layout2-card1-description">${card1Description}</div>
                            </div>
                            <div class="layout2-card1-arrow">›</div>
                        </div>
                        
                        <div class="layout2-card2">
                            <div class="layout2-card2-icon">${card2Icon}</div>
                            <div class="layout2-card2-content">
                                <div class="layout2-card2-title">${card2Title}</div>
                                <div class="layout2-card2-description">${card2Description}</div>
                            </div>
                            <div class="layout2-card2-arrow">›</div>
                        </div>
                    </div>
                </div>
            `;
        }

        function generateLayout3PreviewWithPlaceholders(data, category) {
            const categoryNames = {
                'credito': 'Crédito',
                'debito': 'Débito', 
                'beneficios': 'Benefícios',
                'protecao': 'Proteção'
            };

            return `
                <div class="layout3-container">
                    <div class="layout3-title">${categoryNames[category] || category}</div>
                    <div class="layout3-card1">
                        <div class="layout3-card1-icon">${data.card1?.icon || '📊'}</div>
                        <div class="layout3-card1-content">
                            <div class="layout3-card1-text">
                                <div class="layout3-card1-title">${data.card1?.title || 'Título da Oferta'}</div>
                                <div class="layout3-card1-description">${data.card1?.description || 'Descrição da oferta'}</div>
                            </div>
                        </div>
                    </div>
                    <div class="layout3-cards-row">
                        <div class="layout3-card2">
                            <div class="layout3-card2-icon">${data.card2?.icon || '📈'}</div>
                            <div class="layout3-card2-content">
                                <div class="layout3-card2-title">${data.card2?.title || 'Título da Oferta'}</div>
                                <div class="layout3-card2-description">${data.card2?.description || 'Descrição da oferta'}</div>
                            </div>
                            <div class="layout3-card2-arrow">›</div>
                        </div>
                        <div class="layout3-card3">
                            <div class="layout3-card3-icon">${data.card3?.icon || '📊'}</div>
                            <div class="layout3-card3-content">
                                <div class="layout3-card3-title">${data.card3?.title || 'Título da Oferta'}</div>
                                <div class="layout3-card3-description">${data.card3?.description || 'Descrição da oferta'}</div>
                            </div>
                            <div class="layout3-card3-arrow">›</div>
                        </div>
                    </div>
                </div>
            `;
        }

        function generateLayout4PreviewWithPlaceholders(data, category) {
            const categoryNames = {
                'credito': 'Crédito',
                'debito': 'Débito', 
                'beneficios': 'Benefícios',
                'protecao': 'Proteção'
            };
            const categoryTitle = categoryNames[category] || category;
            
            return `
                <div class="layout4-container">
                    <div class="layout4-title">${categoryTitle}</div>
                    <div class="layout4-card1">
                        <div class="layout4-card1-icon">${data.card1?.icon || '💰'}</div>
                        <div class="layout4-card1-content">
                            <div class="layout4-card1-text">
                                <div class="layout4-card1-title">${data.card1?.title || 'Título da Oferta'}</div>
                                <div class="layout4-card1-description">${data.card1?.description || 'Descrição da oferta'}</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="layout4-card">
                        <div class="layout4-card-icon">${data.card2?.icon || '📊'}</div>
                        <div class="layout4-card-content">
                            <div class="layout4-card-footer">
                                <div class="layout4-card-text">
                                    <div class="layout4-card-title">${data.card2?.title || 'Título da Oferta'}</div>
                                    <div class="layout4-card-description">${data.card2?.description || 'Descrição da oferta'}</div>
                                </div>
                                <div class="layout4-card-arrow">›</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="layout4-card">
                        <div class="layout4-card-icon">${data.card3?.icon || '🍀'}</div>
                        <div class="layout4-card-content">
                            <div class="layout4-card-footer">
                                <div class="layout4-card-text">
                                    <div class="layout4-card-title">${data.card3?.title || 'Título da Oferta'}</div>
                                    <div class="layout4-card-description">${data.card3?.description || 'Descrição da oferta'}</div>
                                </div>
                                <div class="layout4-card-arrow">›</div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function generateOfferPreview(layout, data, category) {
            switch (layout) {
                case 1:
                    return generateLayout1Preview(data, category);
                case 2:
                    return generateLayout2Preview(data, category);
                case 3:
                    return generateLayout3Preview(data, category);
                case 4:
                    return generateLayout4Preview(data, category);
                default:
                    return '<div class="preview-message">Layout não implementado</div>';
            }
        }

        function generateLayout1Preview(data, category) {
            // Mapear nomes das categorias
            const categoryNames = {
                'credito': 'Crédito',
                'debito': 'Débito', 
                'beneficios': 'Benefícios',
                'protecao': 'Proteção'
            };
            const categoryTitle = categoryNames[category] || category;
            const icon = data.icon || '🛡️';
            const title = data.title || 'Título da Oferta';
            const description = data.description || 'Descrição da oferta';
            const cta = data.cta || 'Call to Action';
            
            // Filtrar bullets válidos (com ícone e texto)
            const validBullets = data.bullets?.filter(bullet => 
                bullet.icon && bullet.icon.trim() && bullet.text && bullet.text.trim()
            ) || [];
            
            const bulletsHtml = validBullets.map(bullet => `
                <div class="layout1-bullet">
                    <div class="layout1-bullet-icon">${bullet.icon}</div>
                    <div class="layout1-bullet-text">${bullet.text}</div>
                </div>
            `).join('');

            return `
                <div class="layout1-container">
                    <div class="layout1-title">${categoryTitle}</div>
                    
                    <div class="layout1-card">
                        <div class="layout1-card-icon">${icon}</div>
                        <div class="layout1-card-content">
                            <div class="layout1-card-title">${title}</div>
                            <div class="layout1-card-description">${description}</div>
                            
                            <div class="layout1-bullets">
                                ${bulletsHtml}
                            </div>
                            
                            <div class="layout1-cta">
                                <span>${cta}</span>
                                <div class="layout1-cta-arrow">›</div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function generateLayout2Preview(data, category) {
            // Mapear nomes das categorias
            const categoryNames = {
                'credito': 'Crédito',
                'debito': 'Débito', 
                'beneficios': 'Benefícios',
                'protecao': 'Proteção'
            };
            const categoryTitle = categoryNames[category] || category;
            
            const card1Bg = data.card1?.bg || 'https://images.unsplash.com/photo-1618005198919-d3d4b5a92ead?w=400&q=80';
            const card1Title = data.card1?.title || 'Título';
            const card1Description = data.card1?.description || 'Descrição da oferta';
            
            const card2Icon = data.card2?.icon || '📊';
            const card2Title = data.card2?.title || 'Título';
            const card2Description = data.card2?.description || 'Descrição da oferta';

            return `
                <div class="layout2-container">
                    <div class="layout2-title">${categoryTitle}</div>
                    <div class="layout2-card1" style="background-image: url('${card1Bg}')">
                        <div class="layout2-card1-content">
                            <div class="layout2-card1-text">
                                <div class="layout2-card1-title">${card1Title}</div>
                                <div class="layout2-card1-description">${card1Description}</div>
                            </div>
                            <div class="layout2-card1-arrow">›</div>
                        </div>
                    </div>
                    
                    <div class="layout2-card2">
                        <div class="layout2-card2-icon">${card2Icon}</div>
                        <div class="layout2-card2-content">
                            <div class="layout2-card2-text">
                                <div class="layout2-card2-title">${card2Title}</div>
                                <div class="layout2-card2-description">${card2Description}</div>
                            </div>
                            <div class="layout2-card2-arrow">›</div>
                        </div>
                    </div>
                </div>
            `;
        }

        function generateLayout3Preview(data, category) {
            // Mapear nomes das categorias
            const categoryNames = {
                'credito': 'Crédito',
                'debito': 'Débito', 
                'beneficios': 'Benefícios',
                'protecao': 'Proteção'
            };
            const categoryTitle = categoryNames[category] || category;
            
            const card1Icon = data.card1?.icon || '📊';
            const card1Title = data.card1?.title || 'Título';
            const card1Description = data.card1?.description || 'Descrição';
            
            const card2Icon = data.card2?.icon || '📈';
            const card2Title = data.card2?.title || 'Título';
            const card2Description = data.card2?.description || 'Descrição';
            
            const card3Icon = data.card3?.icon || '💰';
            const card3Title = data.card3?.title || 'Título';
            const card3Description = data.card3?.description || 'Descrição';

            return `
                <div class="layout3-container">
                    <div class="layout3-title">${categoryTitle}</div>
                    
                    <div class="layout3-card1">
                        <div class="layout3-card1-icon">${card1Icon}</div>
                        <div class="layout3-card1-content">
                            <div class="layout3-card1-title">${card1Title}</div>
                            <div class="layout3-card1-description">${card1Description}</div>
                        </div>
                    </div>
                    
                    <div class="layout3-cards-row">
                        <div class="layout3-card">
                            <div class="layout3-card-icon">${card2Icon}</div>
                            <div class="layout3-card-content">
                                <div class="layout3-card-title">${card2Title}</div>
                                <div class="layout3-card-description">${card2Description}</div>
                            </div>
                        </div>
                        
                        <div class="layout3-card">
                            <div class="layout3-card-icon">${card3Icon}</div>
                            <div class="layout3-card-content">
                                <div class="layout3-card-title">${card3Title}</div>
                                <div class="layout3-card-description">${card3Description}</div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function generateLayout4Preview(data, category) {
            // Mapear nomes das categorias
            const categoryNames = {
                'credito': 'Crédito',
                'debito': 'Débito', 
                'beneficios': 'Benefícios',
                'protecao': 'Proteção'
            };
            const categoryTitle = categoryNames[category] || category;
            
            const card1Icon = data.card1?.icon || '💰';
            const card1Title = data.card1?.title || 'Título';
            const card1Description = data.card1?.description || 'Descrição';
            
            const card2Icon = data.card2?.icon || '📊';
            const card2Title = data.card2?.title || 'Título';
            const card2Description = data.card2?.description || 'Descrição';
            
            const card3Icon = data.card3?.icon || '🍀';
            const card3Title = data.card3?.title || 'Título';
            const card3Description = data.card3?.description || 'Descrição';

            return `
                <div class="layout4-container">
                    <div class="layout4-title">${categoryTitle}</div>
                    
                    <div class="layout4-card1">
                        <div class="layout4-card1-icon">${card1Icon}</div>
                        <div class="layout4-card1-content">
                            <div class="layout4-card1-text">
                                <div class="layout4-card1-title">${card1Title}</div>
                                <div class="layout4-card1-description">${card1Description}</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="layout4-card">
                        <div class="layout4-card-icon">${card2Icon}</div>
                        <div class="layout4-card-content">
                            <div class="layout4-card-footer">
                                <div class="layout4-card-text">
                                    <div class="layout4-card-title">${card2Title}</div>
                                    <div class="layout4-card-description">${card2Description}</div>
                                </div>
                                <div class="layout4-card-arrow">›</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="layout4-card">
                        <div class="layout4-card-icon">${card3Icon}</div>
                        <div class="layout4-card-content">
                            <div class="layout4-card-footer">
                                <div class="layout4-card-text">
                                    <div class="layout4-card-title">${card3Title}</div>
                                    <div class="layout4-card-description">${card3Description}</div>
                                </div>
                                <div class="layout4-card-arrow">›</div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function updateFooterPreview() {
            const footerTitle = document.getElementById('footer-title').value || 'Título do Footer';
            const cardTitle = document.getElementById('footer-card-title').value || 'Título da Oferta';
            const cardDescription = document.getElementById('footer-card-description').value || 'Descrição da Oferta';
            
            document.getElementById('footer-title-preview').textContent = footerTitle;
            document.querySelector('.footer-card-title').textContent = cardTitle;
            document.querySelector('.footer-card-description').textContent = cardDescription;
        }
    </script>
</body>
</html>
